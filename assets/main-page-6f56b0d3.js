import{u as g,r as i,C as f,a as h,b as j,c as N,g as p,j as s,L as v,d as _,e as b,f as C,O as P}from"./index-55f31101.js";import{u as O,H as k}from"./header-0ed74950.js";import{u as S}from"./use-navigate-with-params-ea653adc.js";import{C as w,s as E}from"./scroll-into-view-78f4c987.js";const L=a=>a.city.name;function y(){return g(L)}const u=[{label:"Popular",value:"popular-desc"},{label:"Price: low to high",value:"price-asc"},{label:"Price: high to low",value:"price-desc"},{label:"Top rated first",value:"top-desc"}],x=i.memo(()=>{const a=Object.values(f),n=y(),[c]=h(),{setCity:l,resetCity:m}=b,o=j(),r=N(),e=S();return i.useEffect(()=>{const t=e(p(),{city:f.Paris,"sort-by":"popular-desc"});if(c){const d=c.get("city");d?o(l(d)):r(t)}else r(t)},[o,e,r,c,l]),i.useEffect(()=>{const t=c.get("sort-by"),d=e(p(),{"sort-by":"popular-desc"});t||r(d)},[e,r,c]),i.useEffect(()=>()=>{o(m())},[]),s.jsx("div",{className:"tabs",children:s.jsx("section",{className:"locations container",children:s.jsx("ul",{className:"locations__list tabs__list",children:a.map(t=>s.jsx("li",{className:"locations__item",children:s.jsx(v,{className:_("locations__item-link","tabs__item",{"tabs__item--active":n===t}),to:e(p(),{city:t}),children:s.jsx("span",{children:t})})},t))})})})}),R=(a,n)=>{i.useEffect(()=>{const c=l=>{a.current&&!a.current.contains(l.target)&&n()};return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[a,n])},I=i.memo(()=>{const[a,n]=i.useState(!1),c=i.useRef(null),[l,m]=h(),o=i.useMemo(()=>u.find(t=>l.get("sort-by")===t.value)||u[0],[l]);R(c,()=>{a&&n(!1)});const r=i.useCallback(e=>{n(!1),m(t=>{const d=new URLSearchParams(t);return d.set("sort-by",e),d})},[m]);return s.jsxs("form",{className:"places__sorting",action:"#",method:"get",children:[s.jsx("span",{className:"places__sorting-caption",children:"Sort by"}),s.jsxs("span",{className:"places__sorting-type",tabIndex:0,onClick:()=>n(e=>!e),children:[o.label,s.jsx("svg",{className:"places__sorting-arrow",width:"7",height:"4",children:s.jsx("use",{xlinkHref:"#icon-arrow-select"})})]}),s.jsx("ul",{className:_("places__options","places__options--custom",{"places__options--opened":a}),ref:c,children:u.map(e=>s.jsx("li",{onClick:()=>r(e.value),className:_("places__option",{"places__option--active":o.value===e.value}),tabIndex:0,children:e.label},e.value))})]})}),B=i.memo(()=>{const a=O(),n=j(),[c,l]=i.useState(null),[m]=h(),o=m.get("sort-by"),r=i.useCallback(t=>{l(t)},[]),e=y();return i.useEffect(()=>{e&&o&&n(C(e))},[n,e,o]),s.jsxs("div",{className:"page page--gray page--main",children:[s.jsx(k,{}),(a==null?void 0:a.length)===0?s.jsxs("main",{className:"page__main page__main--index page__main--index-empty",children:[s.jsx("h1",{className:"visually-hidden",children:"Cities"}),s.jsx(x,{}),s.jsx("div",{className:"cities",children:s.jsxs("div",{className:"cities__places-container cities__places-container--empty container",children:[s.jsx("section",{className:"cities__no-places",children:s.jsxs("div",{className:"cities__status-wrapper tabs__content",children:[s.jsx("b",{className:"cities__status",children:"No places to stay available"}),s.jsx("p",{className:"cities__status-description",children:"We could not find any property available at the moment in Dusseldorf"})]})}),s.jsx("div",{className:"cities__right-section"})]})})]}):s.jsxs("main",{className:"page__main page__main--index",children:[s.jsx("h1",{className:"visually-hidden",children:"Cities"}),s.jsx(x,{}),s.jsx("div",{className:"cities",children:s.jsxs("div",{className:"cities__places-container container",children:[s.jsxs("section",{className:"cities__places places",children:[s.jsx("h2",{className:"visually-hidden",children:"Places"}),s.jsxs("b",{className:"places__found",children:[a.length," places to stay in"," ",e]}),s.jsx(I,{}),s.jsx("div",{className:"cities__places-list places__list tabs__content",children:s.jsx(P,{offers:a,onActiveOffer:r})})]}),s.jsx("div",{className:"cities__right-section",children:s.jsx(w,{city:e,offers:a,selectedOffer:c,onPointClick:t=>{E(`#${t}`)}})})]})})]})]})});export{B as default};
