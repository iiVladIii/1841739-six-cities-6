import{u as j,r as c,C as N,a as h,b as x,j as e,L as v,c as p,g,d as y,f as b,O as C}from"./index-eb34c2af.js";import{u as P,H as O}from"./Header-71210fe8.js";import{C as S,s as w}from"./scrollIntoView-296ccfe7.js";const E=a=>a.city.name;function f(){return j(E)}const m=[{label:"Popular",value:"popular-desc"},{label:"Price: low to high",value:"price-asc"},{label:"Price: high to low",value:"price-desc"},{label:"Top rated first",value:"top-desc"}],u=c.memo(()=>{const a=Object.values(N),t=f(),[i,l]=h(),{setCity:o,resetCity:n}=y,r=x();return c.useEffect(()=>{if(i){const s=i.get("city");s&&r(o(s))}},[r,i,o]),c.useEffect(()=>()=>{r(n())},[]),c.useEffect(()=>{t&&!i.get("city")&&l(s=>{const d=new URLSearchParams(s);return d.set("city",t),d})},[t,i,l]),e.jsx("div",{className:"tabs",children:e.jsx("section",{className:"locations container",children:e.jsx("ul",{className:"locations__list tabs__list",children:a.map(s=>e.jsx("li",{className:"locations__item",children:e.jsx(v,{className:p("locations__item-link","tabs__item",{"tabs__item--active":t===s}),to:`${g()}?city=${s}`,children:e.jsx("span",{children:s})})},s))})})})}),k=(a,t)=>{c.useEffect(()=>{const i=l=>{a.current&&!a.current.contains(l.target)&&t()};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[a,t])},R=c.memo(()=>{const[a,t]=c.useState(!1),i=c.useRef(null),[l,o]=h(),n=c.useMemo(()=>m.find(d=>l.get("sort-by")===d.value)||m[0],[l]);k(i,()=>{a&&t(!1)});const r=c.useCallback(s=>{t(!1),o(d=>{const _=new URLSearchParams(d);return _.set("sort-by",s),_})},[o]);return e.jsxs("form",{className:"places__sorting",action:"#",method:"get",children:[e.jsx("span",{className:"places__sorting-caption",children:"Sort by"}),e.jsxs("span",{className:"places__sorting-type",tabIndex:0,onClick:()=>t(s=>!s),children:[n.label,e.jsx("svg",{className:"places__sorting-arrow",width:"7",height:"4",children:e.jsx("use",{xlinkHref:"#icon-arrow-select"})})]}),e.jsx("ul",{className:p("places__options","places__options--custom",{"places__options--opened":a}),ref:i,children:m.map(s=>e.jsx("li",{onClick:()=>r(s.value),className:p("places__option",{"places__option--active":n.value===s.value}),tabIndex:0,children:s.label},s.value))})]})}),M=c.memo(()=>{const a=P(),t=x(),[i,l]=c.useState(null),o=c.useCallback(r=>{l(r)},[]),n=f();return c.useEffect(()=>{n&&t(b(n))},[t,n]),e.jsxs("div",{className:"page page--gray page--main",children:[e.jsx(O,{}),(a==null?void 0:a.length)===0?e.jsxs("main",{className:"page__main page__main--index page__main--index-empty",children:[e.jsx("h1",{className:"visually-hidden",children:"Cities"}),e.jsx(u,{}),e.jsx("div",{className:"cities",children:e.jsxs("div",{className:"cities__places-container cities__places-container--empty container",children:[e.jsx("section",{className:"cities__no-places",children:e.jsxs("div",{className:"cities__status-wrapper tabs__content",children:[e.jsx("b",{className:"cities__status",children:"No places to stay available"}),e.jsx("p",{className:"cities__status-description",children:"We could not find any property available at the moment in Dusseldorf"})]})}),e.jsx("div",{className:"cities__right-section"})]})})]}):e.jsxs("main",{className:"page__main page__main--index",children:[e.jsx("h1",{className:"visually-hidden",children:"Cities"}),e.jsx(u,{}),e.jsx("div",{className:"cities",children:e.jsxs("div",{className:"cities__places-container container",children:[e.jsxs("section",{className:"cities__places places",children:[e.jsx("h2",{className:"visually-hidden",children:"Places"}),e.jsxs("b",{className:"places__found",children:[a.length," places to stay in"," ",n]}),e.jsx(R,{}),e.jsx("div",{className:"cities__places-list places__list tabs__content",children:e.jsx(C,{offers:a,onActiveOffer:o})})]}),e.jsx("div",{className:"cities__right-section",children:e.jsx(S,{city:n,offers:a,selectedOffer:i,onPointClick:r=>{w(`#${r}`)}})})]})})]})]})});export{M as default};
