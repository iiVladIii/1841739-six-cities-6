import{u as v,r as t,C as p,a as f,b as j,c as g,g as _,j as e,L as y,d as h,e as b,f as C,O as P}from"./index-329d30e3.js";import{u as O,H as S}from"./header-d9035330.js";import{C as w,s as E}from"./scroll-into-view-cfbd7a14.js";const k=s=>s.city.name;function N(){return v(k)}const u=[{label:"Popular",value:"popular-desc"},{label:"Price: low to high",value:"price-asc"},{label:"Price: high to low",value:"price-desc"},{label:"Top rated first",value:"top-desc"}],x=t.memo(()=>{const s=Object.values(p),a=N(),[i,r]=f(),{setCity:d,resetCity:l}=b,o=j(),c=g();return t.useEffect(()=>{if(i){const n=i.get("city");n?o(d(n)):c(`${_()}?city=${p.Paris}`)}else c(`${_()}?city=${p.Paris}`)},[o,c,i,d]),t.useEffect(()=>()=>{o(l())},[]),t.useEffect(()=>{a&&!i.get("city")&&r(n=>{const m=new URLSearchParams(n);return m.set("city",a),m})},[a,i,r]),e.jsx("div",{className:"tabs",children:e.jsx("section",{className:"locations container",children:e.jsx("ul",{className:"locations__list tabs__list",children:s.map(n=>e.jsx("li",{className:"locations__item",children:e.jsx(y,{className:h("locations__item-link","tabs__item",{"tabs__item--active":a===n}),to:`${_()}?city=${n}`,children:e.jsx("span",{children:n})})},n))})})})}),R=(s,a)=>{t.useEffect(()=>{const i=r=>{s.current&&!s.current.contains(r.target)&&a()};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[s,a])},$=t.memo(()=>{const[s,a]=t.useState(!1),i=t.useRef(null),[r,d]=f(),l=t.useMemo(()=>u.find(n=>r.get("sort-by")===n.value)||u[0],[r]);R(i,()=>{s&&a(!1)});const o=t.useCallback(c=>{a(!1),d(n=>{const m=new URLSearchParams(n);return m.set("sort-by",c),m})},[d]);return e.jsxs("form",{className:"places__sorting",action:"#",method:"get",children:[e.jsx("span",{className:"places__sorting-caption",children:"Sort by"}),e.jsxs("span",{className:"places__sorting-type",tabIndex:0,onClick:()=>a(c=>!c),children:[l.label,e.jsx("svg",{className:"places__sorting-arrow",width:"7",height:"4",children:e.jsx("use",{xlinkHref:"#icon-arrow-select"})})]}),e.jsx("ul",{className:h("places__options","places__options--custom",{"places__options--opened":s}),ref:i,children:u.map(c=>e.jsx("li",{onClick:()=>o(c.value),className:h("places__option",{"places__option--active":l.value===c.value}),tabIndex:0,children:c.label},c.value))})]})}),M=t.memo(()=>{const s=O(),a=j(),[i,r]=t.useState(null),d=t.useCallback(o=>{r(o)},[]),l=N();return t.useEffect(()=>{l&&a(C(l))},[a,l]),e.jsxs("div",{className:"page page--gray page--main",children:[e.jsx(S,{}),(s==null?void 0:s.length)===0?e.jsxs("main",{className:"page__main page__main--index page__main--index-empty",children:[e.jsx("h1",{className:"visually-hidden",children:"Cities"}),e.jsx(x,{}),e.jsx("div",{className:"cities",children:e.jsxs("div",{className:"cities__places-container cities__places-container--empty container",children:[e.jsx("section",{className:"cities__no-places",children:e.jsxs("div",{className:"cities__status-wrapper tabs__content",children:[e.jsx("b",{className:"cities__status",children:"No places to stay available"}),e.jsx("p",{className:"cities__status-description",children:"We could not find any property available at the moment in Dusseldorf"})]})}),e.jsx("div",{className:"cities__right-section"})]})})]}):e.jsxs("main",{className:"page__main page__main--index",children:[e.jsx("h1",{className:"visually-hidden",children:"Cities"}),e.jsx(x,{}),e.jsx("div",{className:"cities",children:e.jsxs("div",{className:"cities__places-container container",children:[e.jsxs("section",{className:"cities__places places",children:[e.jsx("h2",{className:"visually-hidden",children:"Places"}),e.jsxs("b",{className:"places__found",children:[s.length," places to stay in"," ",l]}),e.jsx($,{}),e.jsx("div",{className:"cities__places-list places__list tabs__content",children:e.jsx(P,{offers:s,onActiveOffer:d})})]}),e.jsx("div",{className:"cities__right-section",children:e.jsx(w,{city:l,offers:s,selectedOffer:i,onPointClick:o=>{E(`#${o}`)}})})]})})]})]})});export{M as default};
